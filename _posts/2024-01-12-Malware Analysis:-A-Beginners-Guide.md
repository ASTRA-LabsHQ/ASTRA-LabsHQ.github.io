---
title: "Malware Analysis: A Beginners Guide"
date: 2024-12-01 3:54:00 -0500
categories: [Malware Analysis, Guide]
tags: [malware analysis, guide, static analysis, dynamic analysis, malware analysis lab, malware ecosystem]
description: "An introductory guide to malware analysis, covering static and dynamic analysis, lab setup, and types of malware."
---
![ASTRA Labs Logo](/assets/pictures/horizontalLogo.jpeg)

In this post, we’ll explore the basics of malware analysis, from understanding its methods to setting up a lab and identifying different types of malware. The goal of this post is to introduce these concepts to you at a high level. We'll be diving into greater detail on each section in the later part of this series.

---

## **What is Malware Analysis?**
*Malware analysis* is a critical skill in the cybersecurity world. It allows researchers to dissect malware and study its inner workings. Once the malware has been analyzed, this knowledge can be used to defeat or eliminate it. Artifacts and behaviors extracted from the malware can also help identify it in networks in the future.

With over [1 billion variants of malware](https://www.av-test.org/en/statistics/malware/) and millions of cyberattacks occurring annually, understanding the malware ecosystem and how to defend against it is more crucial than ever.

Before diving into the details of malware analysis, it's important to understand its purpose, common terminology, types of malware, and the approach we'll take. *Malware* can be considered anything that cause harm to a user, computer, or network. This includes things like RATs (Remote Access Trojans), worms, spyware, ransomware, rootkits, credential stealers, and more. 

Malware and its variants are constantly evolving, but there are many common techniques that can be used to analyze it. The specific technique used will depend on the malware being analyzed and your goals.

---

## **The Purpose of Malware Analysis**
The goal of a malware analyst is typically to gather the information needed to respond to a network intrusion or create rules to defend the network in the future. After analyzing a piece of malware, the analyst should be able to determine what the binary is capable of, how it can be detected on the network, and how its damage can be contained.

Imagine yourself as a malware analyst tasked with analyzing a piece of malware that just wreaked havoc on your network. You're sent the sample, you have the tools to analyze it, and now people are looking to you for answers. Do you know what to do next?

If not, the goal of this blog is to get you up to speed so you can immediately jump into action.

Most importantly, malware analysis helps develop host-based and network-based signatures.

- **Host-Based Signatures**: Also known as Indicators of Compromise (IOCs), these are used to detect the presence of malware on the victim's computer. Indicators include the presence of unknown files, execution of unknown processes, unusual outbound connections, and more. These signatures are particularly effective against malware that modifies the host system, as such changes leave detectable artifacts. Once identified, rules such as [YARA](https://yara.readthedocs.io/en/stable/writingrules.html#) rules can be created to consistently detect the same behavior or artifacts across multiple systems.  

- **Network Signatures**: Network signatures are observable patterns in network traffic generated by malware, often captured during its execution. While network IOCs can be identified without performing malware analysis, analyzing the malware sample itself can reveal additional indicators. Combining insights from malware analysis with traffic monitoring during execution provides a more comprehensive understanding of the malware's behavior.

## **Pre-requisites**
Basic malware analysis techniques can be performed by those with little to no experience in security or programming. Thanks to advanced tools, you can go from knowing nothing about malware to extracting Indicators of Compromise (IOCs) in no time. However, having programming experience is recommended before diving into malware analysis. The necessary security-related knowledge will be taught as we progress through this series.

## **Types of Malware**
- **Ransomware**: Malware that encrypts files or systems, demanding payment (often in cryptocurrency) for decryption keys. This is a popular strain of malware among cyber-criminals and has been known to target large businesses, critical infrastructure, and even hospitals. 
    - Example strain: [WannaCry](https://people-ece.vse.gmu.edu/coursewebpages/ECE/ECE646/F20/project/F18_presentations/Session_III/Session_III_Report_3.pdf), which caused a global crisis in 2017

    ![WannaCry](/assets/pictures/Blogs/MalwareAnalysisABeginnersGuide/WannaCryScreen.png)

> We'll do our own analysis of WannaCry in a future blog. Stay tuned!
{: .prompt-info }

- **Trojans**: Malware disguised as legitimate software to trick users into installing it, often used to deliver additional payloads.
    - Example strain: [Emotet](https://www.cisa.gov/news-events/cybersecurity-advisories/aa20-280a)
- **Worms**: Self-replicating malware that spreads autonomously across networks without user interaction.
    - Example strain: [Conficker](https://www.radware.com/security/ddos-knowledge-center/ddospedia/conficker/)
- **Rootkits**: Malware designed to hide itself and other malicious software, often at the kernel level, to evade detection.
    - Example strain: [ZeroAccess](https://docs.broadcom.com/doc/trojan-zeroaccess-infection-analysis-12-en)
- **Adware/Spyware**: Malware that tracks user behavior (spyware) or serves intrusive ads (adware), often used for data collection or financial gain.
    - Example strain: [FinFisher](https://www.microsoft.com/en-us/security/blog/2018/03/01/finfisher-exposed-a-researchers-tale-of-defeating-traps-tricks-and-complex-virtual-machines/)
- **Keyloggers** – Malware that records keystrokes to steal sensitive information like passwords.
    - Example strain:[Agent Tesla](https://www.blackberry.com/us/en/solutions/endpoint-security/ransomware-protection/agent-tesla) 
- **Credential Stealers** – Specialized malware designed to steal stored credentials from browsers or applications.
    - Example strain: [RedLine Stealer](https://www.mcafee.com/blogs/other-blogs/mcafee-labs/redline-stealer-a-novel-approach/)
- **Botnets** – Malware that turns infected machines into "bots" for launching distributed attacks or spam campaigns.
    - Example strain: [Mirai Botnet](https://blog.cloudflare.com/inside-mirai-the-infamous-iot-botnet-a-retrospective-analysis/), which exploited IoT devices for large-scale DDoS attacks.
- **Backdoors** – Malware that provides unauthorized access to a system.
    - Example strain: [PlugX](https://any.run/malware-trends/plugx/)
- **Fileless Malware** – Malware that resides in memory and doesn't leave traditional file-based artifacts.
    - Example strain: [Cobalt Strike](https://www.cynet.com/network-attacks/cobalt-strike-white-hat-hacker-powerhouse-in-the-wrong-hands/), often used in advanced persistent threat (APT) campaigns.
- **Cryptominers** – Malware that hijacks system resources to mine cryptocurrency.
    - Example strain: [CoinMiner](https://www.triskelelabs.com/investigating-monero-coin-miner), which targets both personal and enterprise devices.

Malware often shares multiple attributes from the categories mentioned above. For example, a sample could be a trojan containing a keylogger and backdoor, which enables initial access for deploying ransomware. These classifications help categorize malware at a high level.

## **Static Analysis**
- What is static analysis?
- Tools used (e.g., Ghidra, IDA Pro).
- What you can learn without executing the malware.

---

## **Dynamic Analysis**
- What is dynamic analysis?
- Tools and techniques (e.g., Procmon, Wireshark).
- Observing malware behavior in action.

---

## **Setting Up a Malware Analysis Lab**
- Key components of a secure lab environment.
- Tools and virtualization (e.g., VirtualBox, FlareVM).
- Tips for isolating the malware.

---

---

## **Conclusion**
- Recap the importance of malware analysis.
- Tease the next post in the series (e.g., "In our next post, we’ll dive deeper into static analysis techniques and tools.").

---

*Ready to learn more? Stay tuned for the next post in our malware analysis series!*