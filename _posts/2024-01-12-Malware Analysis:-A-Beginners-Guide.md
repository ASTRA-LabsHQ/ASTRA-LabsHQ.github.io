---
title: "Malware Analysis: A Beginners Guide"
date: 2024-12-01 3:54:00 -0500
categories: [Malware Analysis, Guide]
tags: [malware analysis, guide, static analysis, dynamic analysis, malware analysis lab, malware ecosystem]
description: "An introductory guide to malware analysis, covering static and dynamic analysis, and types of malware."
---
![ASTRA Labs Logo](/assets/pictures/horizontalLogo.jpeg)

[![Hits](https://hits.seeyoufarm.com/api/count/incr/badge.svg?url=https%3A%2F%2Fastra-labs.co%2Fposts%2FMalware-Analysis-A-Beginners-Guide%2F&count_bg=%232C2E47&title_bg=%231E1E2E&icon=tor.svg&icon_color=%23E7E7E7&title=views&edge_flat=false)](https://hits.seeyoufarm.com)

In this post, we’ll explore the basics of malware analysis, from understanding the common techniques used to the different strains of malware that create the digital ecosystem of today. The goal of this post is to introduce these concepts to you at a high level. We'll be diving into greater detail on each section in the later part of this series.

---

## **What is Malware Analysis?**
*Malware analysis* is a critical skill in the cybersecurity world. It allows researchers to dissect malware and study its inner workings. Once the malware has been analyzed, the artifacts and behaviors extracted can help us understand and defend against it in the future. 

With over [1 billion variants of malware](https://www.av-test.org/en/statistics/malware/) and millions of cyberattacks occurring annually, understanding the malware ecosystem and how to defend against it is more crucial than ever.

Before diving into the details of malware analysis, it's important to understand its purpose, common terminology, types of malware, and the approach we'll take. *Malware* can be considered anything that causes harm to a user, computer, or network. This includes software like RATs (Remote Access Trojans), worms, spyware, ransomware, rootkits, credential stealers, and more.

To see where these steps fit into the bigger picture, take a look at the malware attack lifecycle graphic below.

![ASTRA Labs Logo](/assets/pictures//Blogs/MalwareAnalysisABeginnersGuide/Malware%20Attack%20Lifecycle.png)

Malware and its variants are constantly evolving, but many common techniques are used to analyze it. The specific technique used will depend on the malware being analyzed and the goals of the analyst. 


---

## **The Purpose of Malware Analysis**
The goal of a malware analyst is to gather the information needed to respond to a network intrusion or create rules to defend the network in the future. After analyzing malware, the analyst should be able to determine what the binary is capable of, how it can be detected on the network, and how its damage can be contained.

Imagine being tasked with analyzing malware that wreaked havoc on your network. You're sent the sample, equipped with the tools to analyze it, and now everyone is looking to you for answers. What would you do next?

If you’re unsure, the goal of this blog series is to get you up to speed so you can take immediate action when faced with such a task.

One of the most effective ways to defend against malware is by developing host-based and network-based signatures.

- **Host-Based Signatures**: Also known as Indicators of Compromise (IOCs), are used to detect the presence of malware on a victim's computer. Indicators include the presence of unknown files, execution of unknown processes, unusual outbound connections, and more. These signatures are particularly effective against malware that modifies the host system, as such changes leave detectable artifacts. Once identified, rules such as [YARA](https://yara.readthedocs.io/en/stable/writingrules.html#) rules can be created to consistently detect the same behavior or artifacts across multiple systems.  

- **Network Signatures**: Network signatures are observable indicators or patterns in network traffic generated by the malware, which are often captured during its execution. While network IOCs can be identified without performing malware analysis, analyzing the malware sample itself can reveal additional indicators. Combining indicators and cross referencing malware analysis with network traffic monitoring during execution provides the most comprehensive understanding of the malware's behavior. This is essential for understanding the extent of the infection. 

--- 

## **Pre-requisites**
Basic malware analysis techniques can be performed by those with little to no experience in security or programming. Thanks to advanced tools, you can go from knowing nothing about malware to extracting Indicators of Compromise (IOCs) rather quickly. However, having programming experience is recommended before diving into malware analysis. The necessary security-related knowledge will be taught as we progress through this series.

---

## **Types of Malware**
- **Ransomware**: Malware that encrypts files or systems, demanding payment (often in cryptocurrency) for decryption keys. Ransomware is popular among cyber-criminals and has been known to target large businesses, critical infrastructure, and even hospitals. 
    - Example strain: [WannaCry](https://people-ece.vse.gmu.edu/coursewebpages/ECE/ECE646/F20/project/F18_presentations/Session_III/Session_III_Report_3.pdf), which caused a global crisis in 2017

    ![WannaCry](/assets/pictures/Blogs/MalwareAnalysisABeginnersGuide/WannaCryScreen.png)

> We'll do our own analysis of WannaCry in a future blog. Stay tuned!
{: .prompt-info }

- **Trojans**: Malware disguised as legitimate software to trick users into installing it, often used to deliver additional payloads.
    - Example strain: [Emotet](https://www.cisa.gov/news-events/cybersecurity-advisories/aa20-280a)
- **Worms**: Self-replicating malware that spreads autonomously across networks without user interaction.
    - Example strain: [Conficker](https://www.radware.com/security/ddos-knowledge-center/ddospedia/conficker/)
- **Rootkits**: Malware designed to hide itself and other malicious software, often at the kernel level, to evade detection.
    - Example strain: [ZeroAccess](https://docs.broadcom.com/doc/trojan-zeroaccess-infection-analysis-12-en)
- **Adware/Spyware**: Malware that tracks user behavior (spyware) or serves intrusive ads (adware), often used for data collection or financial gain.
    - Example strain: [FinFisher](https://www.microsoft.com/en-us/security/blog/2018/03/01/finfisher-exposed-a-researchers-tale-of-defeating-traps-tricks-and-complex-virtual-machines/)
- **Keyloggers** – Malware that records keystrokes to steal sensitive information like passwords.
    - Example strain: [Agent Tesla](https://www.blackberry.com/us/en/solutions/endpoint-security/ransomware-protection/agent-tesla) 
- **Credential Stealers** – Specialized malware designed to steal stored credentials from browsers or applications.
    - Example strain: [RedLine Stealer](https://www.mcafee.com/blogs/other-blogs/mcafee-labs/redline-stealer-a-novel-approach/)
- **Botnets** – Malware that turns infected machines into "bots" for launching distributed attacks or spam campaigns.
    - Example strain: [Mirai Botnet](https://blog.cloudflare.com/inside-mirai-the-infamous-iot-botnet-a-retrospective-analysis/), which exploited IoT devices for large-scale DDoS attacks.
- **Backdoors** – Malware that provides unauthorized access to a system.
    - Example strain: [PlugX](https://any.run/malware-trends/plugx/)
- **Fileless Malware** – Malware that resides in memory and doesn't leave traditional file-based artifacts.
    - Example strain: [Cobalt Strike](https://www.cynet.com/network-attacks/cobalt-strike-white-hat-hacker-powerhouse-in-the-wrong-hands/), often used in advanced persistent threat (APT) campaigns.
- **Cryptominers** – Malware that hijacks system resources to mine cryptocurrency.
    - Example strain: [CoinMiner](https://www.triskelelabs.com/investigating-monero-coin-miner), which targets both personal and enterprise devices.

Malware often shares multiple attributes from the categories mentioned above. For example, a sample could be a trojan containing a keylogger and backdoor, which enables initial access for deploying ransomware. These classifications help categorize malware at a high level.

---

## **Techniques for Malware Analysis**
If you thought you'd be given the source code of the malware sample to analyze you'd be sorely mistaken. In most cases, you're given the compiled version which isn't human readable and you're goal is to try and understand it. This is where the tools and techniques mentioned come into play. Each tool has a purpose in unveiling what the sample is doing bit by bit. There are two approaches for analysis, one being static analysis and the other dynamic analysis. These can later be broken into basic static analysis, advanced static analysis, basic dynamic analysis, and advanced dynamic analysis. As the name suggest, static analysis is analyzing the malware **without** running it and dynamic analysis involves analyzing the sample **while** runnning it. Hybrid analysis is another popular technique which combines both static and dynamic analysis.

![Malware Analysis Techniques](/assets/pictures/Blogs/MalwareAnalysisABeginnersGuide/MATGraphic.png)

---

## **Basic Static Analysis**
Basic static analysis involves extracting information from a binary without examining its instructions. The goal is to quickly assess whether a file is malicious or not by gathering data such as file metadata, strings, and hashes. Common tools for this phase include strings, [FLOSS](https://github.com/mandiant/flare-floss), and [PEStudio](https://www.winitor.com/download). Indicators gathered during this phase can be used to create network signatures. Basic static analysis is not comprehensive and may fail to detect advanced malware, so this limitation should always be kept in mind when analyzing a sample.

---

## **Advanced Static Analysis**
Advanced static analysis consist of reverse engineering the malware's internal workings by loading the binary into a **disassembler** to examine its low-level instructions. A disassembler is a tool that converts machine code from a binary into assembly language, some of the most popular disassemblers include [Ghidra](https://ghidra-sre.org/), [IDA Pro](https://hex-rays.com/ida-pro), and [Binary Ninja](https://binary.ninja/). Mastering advanced static analysis can be very challenging, as it demands a strong understanding of operating system fundamentals, assembly language, and programming constructs.

--- 

## **Basic Dynamic Analysis**
Basic dynamic analysis is one of the most engaging parts of malware analysis. This is where the sample is detonated to observe its behaviors on the system. By monitoring the network and host before, during, and after detonation, you can identify the Indicators of Compromise (IOCs) mentioned earlier. These indicators can then be turned into signatures to help detect or protect against the malware in the future.

However, similar to basic static analysis, dynamic analysis may not always provide a comprehensive picture. Malware often employs techniques like virtual machine (VM) detection and other safeguards to evade analysis. Detonating a sample with these safeguards in place may lead you to believe the file is not malicious, when in reality, it recognized it was being analyzed and either withheld certain functions or activated decoy behaviors to mask its true malicious nature.

> An isolated and secure environment is required for dynamic analysis
{: .prompt-danger }

---

## **Advanced Dynamic Analysis**
Advanced dynamic analysis often involves using a **debugger**. A debugger is a tool that allows analysts to run a program step by step, inspect its execution flow, and analyze its behavior in real time. It’s essential for identifying runtime actions such as function calls, memory modifications, and network activity. Popular debuggers include [x64dbg](https://x64dbg.com/), [GDB](https://sourceware.org/gdb/), and [WinDbg](https://learn.microsoft.com/en-us/windows-hardware/drivers/debugger/). 

One of the key advantages of using a debugger is the ability to walk through the code step by step. For example, in basic dynamic analysis, I mentioned how malware can detect that it is running in a virtual environment and withhold its malicious behavior. How can you uncover this behavior? By stepping through the code, you can identify checks for the presence of a hypervisor and modify the relevant flags, forcing the malware to execute its hidden functionality. This technique enables you to extract more information from the sample than would otherwise be possible.

---

## **Conclusion**
In this post, we introduced the core concepts of malware analysis, including its purpose, techniques, and types of malware. As we progress through this series, we’ll dive deeper into the tools and methodologies needed to perform both static and dynamic analysis. Stay tuned for the next post, where we’ll explore the foundational steps for setting up a secure malware analysis lab.

---

*Ready to learn more? Stay tuned for the next post in our malware analysis series!*